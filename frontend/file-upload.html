<!DOCTYPE html>
<html lang="en">

<head>
    <link href='//fonts.googleapis.com/css?family=Clicker Script' rel='stylesheet'>
    <link href='//fonts.googleapis.com/css?family=Amita' rel='stylesheet'>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="main_page.css">
    <link rel="stylesheet" href="admin-login.css">
    <link rel="stylesheet" href="file-upload.css">
    <meta charset="UTF-8">
    <title>Document</title>
</head>

<body>
    <div class="container-fluid">
        <section id="logo-section"> <span id="logo">Haj és SzépségÁpolás</span> </section>
        <section id="news">
            <label class="custom-file">
                <input type="file" id="file" class="custom-file-input">
                <input type="text" id=file-name> <span class="custom-file-control btn btn-default pull-righ">Tallózás</span> </label>
            <div class="file-drop"> <span id="dropzone-message">Ide húzd a képeidet!</span> </div>
        </section>
    </div>
    <script>
        $('input:file').change(function (e) {
            e.preventDefault();
            $('#file-name').val(e.target.files[0].name);
        });
        $('.file-drop').on('dragenter dragstart dragend dragleave dragover drag drop', function (ev) {
            ev.preventDefault();
        });
        $('.file-drop').on('drop', function (ev) {
            console.log('event detected');
            ev.preventDefault();
            var files = ev.originalEvent.dataTransfer.files;
            var images = $.grep(files, function (file) {
                return file.type.indexOf("image/") === 0; // filter out images
            });
            var formData = new FormData();
            $.each(images, function (i) {
                formData.append(i, this);
            });
            console.log('starting placement');
            var imageCount = images.length;
            var imagePerRow = 12;
            console.log('variables alright');
            for (var k = 1; k <= Math.ceil(imageCount / imagePerRow); k++) {
                console.log('for 1');
                var row = $('<div>').addClass('row');
                console.log('for 2');
                $('.file-drop').append(row);
                console.log('row ready');
                for (var j = 0; j < imagePerRow; j++) {
                    var img = $('<img>').attr('alt', images[k * j].name);
                    var p = $('<p>').text(images[k * j].name);
                    var caption = $('<div>').addClass('caption');
                    var thumbnail = $('<div>').addClass('thumbnail').addClass('col-md-1');
                    caption.append(p);
                    thumbnail.append(img);
                    thumbnail.append(caption);
                    console.log('image created');
                    img.file = images[k * j];
                    row.append(thumbnail);
                    console.log('image appended');
                    var reader = new FileReader();
                    reader.onload = (function (aImg) {
                        return function (e) {
                            aImg.attr('src', e.target.result);
                        };
                    })(img);
                    reader.readAsDataURL(images[k * j]);
                    console.log('image added fully');
                }
            }
        });
    </script>
</body>

</html>